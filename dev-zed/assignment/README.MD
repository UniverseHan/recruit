# ZIGBANG ZED Assignment

지원자: 석한울  
이메일: hanwool.seok@gmail.com

과제 제출합니다.

마음은 웹 어셈블리도 공부해서 리액트로 웹버젼도 구현하고 싶었지만. 육아를하느라 한주를 다 보내고.. 마지막날에 급하게 과제 요구사항만 겨우 맞춰 버렸네요.. 후우..

문제 준비하시느라 고생하셨습니다. (_ _ )...

# 문제 해결 방법 (자유롭게 작성)
## JSON Load
단순하게 문제에서 설명된 방법을 사용하여 JSON객체를 로드 하였다. 서버의 응답을 담을 Response 객체를 만들어서 사용하였다.

## Float[] 파싱
문제에서 제시된 방법으로 byte[]를 순회하면서 정점들을 파싱 하였다.

## 정점 인코딩
문제에서 설명한 방법대로. Convert.FromBase64String() 함수와 Buffer.BlockCopy 함수를 사용하여 정점 하나에 float 3개씩 바이트 버퍼로 부터 추출 하였다.

## 정점 -> Mesh
처음엔 정점이 최적화 되었거나. 면당 4개의 정점을 사용하고 인덱스를 사용하여 매시가 구성되었을 것이라고 예상 하였다. 하지만 정점들은 단순히 폴리곤 단위로 전부 구성 되어 있었다.

## 폴리콘의 정점 익덱스 생성
정점들이 단순히 폴리콘바다 별도로 구성되어 있었기 때문에 인덱스는 순서대로 증가하기만 하면 되었다.

## 아파트의 높이 계산
단순히 모든 정점들을 순회하면서 계산하였다. maxY - minY = height

## 텍스처 uv매핑
텍스터를 자세히 들여다 보니 정사각형의 격자로 나누어져 있었고 이것의 숫자를세어 영역을 구분하였다. 예를들어 1영역이 차지하는 가로는 24블럭중 12개의 부분을 차지 하기때문에 u좌표의 경계를 1영역 블럭개수 / 전체 가로 블록개수 즉  12.0f / 24.0f로 계산하였다.

## 아파트 방향 계산
- normal 벡터 계산, 선형대수학 시간에 배운 공식 AXB / |AXB| = norm 공식을 이용하여 구할 수 있었다.
- 상,하 방향은 단순히 기준 벡터와의 내적을 이용하였고 내적이 1 이거나 -1이면 같은 방향이거나 반대방향임을 의미하므로. 위를 보고 있거나 아래를 보는 면으로 판단 할 수 있다.
- 아파타의 바라보는 방향을 바닥면과 수평이 아닐 수 있어, 우선 바닦면과 평행하게 프로젝션을 할 필요가 있으나 좌표 축으로 이루어진 평면이기 때문에 단순히 노멀 벡터의 y요소만 제거하여 구할 수 있었다.
- forware방향을 이루는 백터와 아파트면과의 각도는 내적공식을 이용하여 구할 수 있다. A*B = |A|*|B|cos@ 로 두고 @에 대해서 풀면 각도를 구할 수 있지만. cos의 범위는 0도 ~ 180도에대해 -1 ~ 1의 범위만 표현 할 수 있기 때문에 180도 이상을 계산 하려면 마이너스 값일때와 각도를 같이 고려해주어야 한다.

## 게임 오프젝트의 생성
- 유니티의 게임오브젝트를 코드를 통해 생성
- 렌너링을 위해 MeshFilter컴포넌트 추가.
- 화면에 보이기 위해 MeshRenderer를 추가하고 쉐이더와 텍스쳐를 추가
- 텍스처 매핑을 잘 적용하기 위해서는 Shader.Find()함수를 사용할때 결과를 체크해야 한다. `Shader.Find("Unlit/Texture")` 를 사용하여 구현 `Shader.Find("Standard")`는 동작 하지 않을 수도 있다.


# 개선할 사항
- 중복 정점들을 제거하고 인덱스를 사용하여 메모리를 절약할 수 있다. (하지만 텍스쳐를 구성하기 위해서는 다른 면은 별도의 정점을 사용해야 할것 같다..)
- 사실 모든 매쉬데이터가 거의 동일한 형태를 띄기 떄문에, 동일한 모양의 아파트는 동일한 정점을 가진 매쉬데이터를 사용하고 단순히 트렌스폼만 다르게 하여 최적호 할 수 있다.
- 데이터를 로드하는 부분과 매시를 만들어 내는 부분, 그리고 게임오브젝트를 생성하는 부분을 분리하여 코드를 좀 더 유연하고 읽기 쉽게 만들 수 있다.



